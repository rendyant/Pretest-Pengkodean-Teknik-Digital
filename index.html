<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Ultimate Pretest — Pengkodean</title>

    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800;900&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        :root {
            --color-bg-1: #0a0e1a;
            --color-bg-2: #0f1420;
            --color-text-primary: #f1f5f9;
            --color-text-secondary: #94a3b8;
            --color-accent-blue: #3b82f6;
            --color-accent-purple: #8b5cf6;
            --color-red: #ef4444;
            --color-green: #10b981;
            --card-border: rgba(148, 163, 184, 0.15);
            --card-bg: rgba(15, 20, 32, 0.6);
            --card-shadow: 0 20px 60px rgba(0, 0, 0, 0.5), inset 0 1px 0 rgba(255, 255, 255, 0.05);
            --icon-bg: rgba(59, 130, 246, 0.1);
        }

        html.light {
            --color-bg-1: #f8fafc;
            --color-bg-2: #ffffff;
            --color-text-primary: #0f172a;
            --color-text-secondary: #64748b;
            --color-accent-blue: #2563eb;
            --color-accent-purple: #7c3aed;
            --color-red: #dc2626;
            --color-green: #059669;
            --card-border: rgba(15, 23, 42, 0.1);
            --card-bg: #ffffff;
            --card-shadow: 0 10px 40px rgba(0, 0, 0, 0.06);
            --icon-bg: rgba(37, 99, 235, 0.08);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        html, body { height: 100%; }
        
        body {
            font-family: 'Inter', system-ui, -apple-system, sans-serif;
            background: var(--color-bg-1);
            color: var(--color-text-primary);
            overflow-x: hidden;
            position: relative;
        }

        /* Animated Gradient Background */
        body::before {
            content: '';
            position: fixed;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle at 30% 40%, rgba(59, 130, 246, 0.15) 0%, transparent 50%),
                        radial-gradient(circle at 70% 60%, rgba(139, 92, 246, 0.12) 0%, transparent 50%),
                        radial-gradient(circle at 50% 50%, rgba(16, 185, 129, 0.08) 0%, transparent 70%);
            animation: gradientShift 20s ease infinite;
            z-index: -1;
        }

        html.light body::before {
            background: radial-gradient(circle at 30% 40%, rgba(37, 99, 235, 0.08) 0%, transparent 50%),
                        radial-gradient(circle at 70% 60%, rgba(124, 58, 237, 0.06) 0%, transparent 50%);
        }

        @keyframes gradientShift {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            33% { transform: translate(10%, -10%) rotate(120deg); }
            66% { transform: translate(-10%, 10%) rotate(240deg); }
        }

        /* Navbar - Ultra Modern Glass */
        .navbar-glass {
            background: rgba(10, 14, 26, 0.7);
            backdrop-filter: blur(20px) saturate(180%);
            -webkit-backdrop-filter: blur(20px) saturate(180%);
            border-bottom: 1px solid var(--card-border);
            box-shadow: 0 4px 24px rgba(0, 0, 0, 0.1);
        }

        html.light .navbar-glass {
            background: rgba(255, 255, 255, 0.8);
        }

        /* Premium Card Design */
        .card-surface {
            position: relative;
            border-radius: 20px;
            border: 1px solid var(--card-border);
            background: var(--card-bg);
            backdrop-filter: blur(16px);
            box-shadow: var(--card-shadow);
            overflow: hidden;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .card-surface::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
        }

        .card-surface:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 30px 80px rgba(59, 130, 246, 0.3), 
                        0 0 0 1px rgba(59, 130, 246, 0.2);
            border-color: rgba(59, 130, 246, 0.4);
        }

        html.light .card-surface:hover {
            box-shadow: 0 20px 60px rgba(37, 99, 235, 0.2);
        }

        /* Glowing Number Effect */
        .card-number {
            background: linear-gradient(135deg, var(--color-accent-blue), var(--color-accent-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            filter: drop-shadow(0 0 20px rgba(59, 130, 246, 0.5));
            animation: pulse 3s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; filter: drop-shadow(0 0 20px rgba(59, 130, 246, 0.5)); }
            50% { opacity: 0.8; filter: drop-shadow(0 0 30px rgba(59, 130, 246, 0.7)); }
        }

        .card-surface:hover::after {
            content: '';
            position: absolute;
            inset: 0;
            background: radial-gradient(circle at var(--mouse-x, 50%) var(--mouse-y, 50%), 
                        rgba(59, 130, 246, 0.15) 0%, 
                        transparent 50%);
            opacity: 0;
            animation: ripple 0.6s ease-out;
            pointer-events: none;
        }

        @keyframes ripple {
            to { opacity: 1; transform: scale(2); }
        }

        /* Premium Buttons */
        .btn-action {
            position: relative;
            padding: 12px 28px;
            border-radius: 12px;
            font-weight: 700;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            overflow: hidden;
            border: none;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }

        .btn-action::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transform: translateX(-100%);
            transition: transform 0.6s;
        }

        .btn-action:hover::before {
            transform: translateX(100%);
        }

        .btn-action-primary {
            background: linear-gradient(135deg, #3b82f6, #8b5cf6);
            color: white;
            box-shadow: 0 8px 24px rgba(59, 130, 246, 0.4);
        }

        .btn-action-primary:hover {
            box-shadow: 0 12px 36px rgba(59, 130, 246, 0.6);
            transform: translateY(-2px);
        }

        .btn-icon {
            padding: 10px;
            border-radius: 12px;
            background: var(--icon-bg);
            border: 1px solid var(--card-border);
            transition: all 0.3s;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }

        .btn-icon:hover {
            background: var(--color-accent-blue);
            border-color: var(--color-accent-blue);
            transform: scale(1.1);
            box-shadow: 0 4px 16px rgba(59, 130, 246, 0.4);
        }

        .btn-icon:hover i {
            color: white !important;
        }

        /* Modal Animations */
        @keyframes modalEnter {
            from {
                opacity: 0;
                transform: scale(0.95) translateY(20px);
            }
            to {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }

        @keyframes overlayFade {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-anim {
            animation: modalEnter 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .overlay-anim {
            animation: overlayFade 0.3s ease;
        }

        /* Smooth Entrance for Cards */
        @keyframes cardEnter {
            from {
                opacity: 0;
                transform: translateY(30px) scale(0.9);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        /* Focus States */
        .focus-ring:focus {
            outline: 3px solid var(--color-accent-blue);
            outline-offset: 3px;
        }

        /* Scrollbar Styling */
        ::-webkit-scrollbar {
            width: 10px;
        }

        ::-webkit-scrollbar-track {
            background: var(--color-bg-1);
        }

        ::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, var(--color-accent-blue), var(--color-accent-purple));
            border-radius: 10px;
        }

        /* Badge Design */
        .badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            background: var(--icon-bg);
            border: 1px solid var(--card-border);
        }

        /* Header Title Animation */
        .hero-title {
            background: linear-gradient(135deg, #f1f5f9, #3b82f6, #8b5cf6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: gradientText 8s ease infinite;
            background-size: 200% 200%;
        }

        html.light .hero-title {
            background: linear-gradient(135deg, #0f172a, #2563eb, #7c3aed);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            background-size: 200% 200%;
        }

        @keyframes gradientText {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        /* Timer Display */
        .timer-display {
            font-size: 3rem;
            font-weight: 900;
            letter-spacing: 0.05em;
            background: linear-gradient(135deg, var(--color-accent-blue), var(--color-accent-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .timer-display.warning {
            background: linear-gradient(135deg, #f59e0b, #ef4444);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: timerPulse 1s ease-in-out infinite;
        }

        @keyframes timerPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        /* Stats Card */
        .stats-card {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(139, 92, 246, 0.1));
            border: 1px solid var(--card-border);
            border-radius: 16px;
            padding: 20px;
            backdrop-filter: blur(10px);
        }

        /* Opened Question Marker */
        .question-opened {
            border: 2px solid var(--color-green) !important;
            background: rgba(16, 185, 129, 0.05);
        }

        .question-opened::after {
            content: '✓';
            position: absolute;
            top: 8px;
            right: 8px;
            background: var(--color-green);
            color: white;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: bold;
        }

        @media print {
            .no-print { display: none !important; }
        }
    </style>
</head>
<body class="min-h-screen">

    <header class="w-full sticky top-0 z-50 navbar-glass transition-all duration-300 no-print">
        <div class="max-w-7xl mx-auto px-6 py-4 flex items-center justify-between">
            <div class="flex items-center gap-3">
                <div class="p-2 rounded-xl bg-gradient-to-br from-blue-500 to-purple-600 shadow-lg shadow-blue-500/50">
                    <i data-lucide="zap" class="w-6 h-6 text-white"></i>
                </div>
                <div>
                    <div class="text-xl font-extrabold text-[--color-text-primary] tracking-tight">Ultimate Pretest</div>
                    <div class="text-xs text-[--color-text-secondary] hidden sm:block">Pengkodean dan Logika</div>
                </div>
            </div>

            <div class="flex items-center gap-3">
                <button id="leaderboardBtn" class="btn-action bg-gradient-to-r from-amber-500 to-orange-600 hover:from-amber-600 hover:to-orange-700 text-white shadow-lg shadow-amber-500/30 focus-ring">
                    <i data-lucide="trophy" class="w-4 h-4"></i>
                    <span class="hidden sm:inline ml-2">Leaderboard</span>
                </button>

                <button id="themeToggle" class="btn-icon focus-ring" title="Ganti Tema">
                    <i id="themeIcon" data-lucide="sun" class="w-5 h-5 text-[--color-text-primary]"></i>
                </button>
                
                <button id="adminBtn" class="btn-action bg-gradient-to-r from-red-500 to-pink-600 hover:from-red-600 hover:to-pink-700 text-white shadow-lg shadow-red-500/30 focus-ring">
                    <i data-lucide="shield" class="w-4 h-4"></i>
                    <span class="hidden sm:inline ml-2">Admin</span>
                </button>
            </div>
        </div>
    </header>

    <main class="max-w-7xl mx-auto px-6 py-20">
        
        <section class="mb-20 text-center">
            <div class="badge mx-auto mb-6">
                <i data-lucide="sparkles" class="w-4 h-4"></i>
                <span>Premium Learning Experience</span>
            </div>
            <h1 class="text-6xl md:text-8xl font-black leading-tight tracking-tighter hero-title mb-6">
                Pretest Pengkodean
            </h1>
            <p class="mt-6 text-m md:text-l text-[--color-text-secondary] max-w-3xl mx-auto leading-relaxed">
                "Yuk main tebak-tebakan encoder dan decoder!
                Kalau kamu bingung, itu wajar… soalnya otak manusia memang bukan IC 74LS138.
                Tapi coba aja dulu, siapa tahu hari ini sinyal logika di kepalamu lagi HIGH semua."
            </p>
        </section>

        <!-- Timer & Stats Section -->
        <section class="mb-12 grid md:grid-cols-2 gap-6">
            <!-- Timer Card -->
            <div class="card-surface p-8">
                <div class="flex items-center gap-3 mb-6">
                    <div class="p-3 rounded-xl bg-gradient-to-br from-blue-500 to-purple-600 shadow-lg">
                        <i data-lucide="clock" class="w-6 h-6 text-white"></i>
                    </div>
                    <div>
                        <h3 class="text-2xl font-black text-[--color-text-primary]">Timer</h3>
                        <p class="text-sm text-[--color-text-secondary]">Atur waktu pengerjaan</p>
                    </div>
                </div>

                <div class="text-center mb-6">
                    <div id="timerDisplay" class="timer-display">15:00</div>
                </div>

                <div class="flex gap-3 mb-6 flex-wrap justify-center">
                    <button class="timer-preset btn-action bg-gray-600 hover:bg-gray-700 text-white text-sm" data-minutes="3">3 min</button>
                    <button class="timer-preset btn-action bg-gray-600 hover:bg-gray-700 text-white text-sm" data-minutes="5">5 min</button>
                    <button class="timer-preset btn-action bg-gray-600 hover:bg-gray-700 text-white text-sm" data-minutes="10">10 min</button>
                    <button class="timer-preset btn-action bg-blue-600 hover:bg-blue-700 text-white text-sm" data-minutes="15">15 min</button>
                </div>

                <div class="flex gap-3 justify-center">
                    <button id="timerPlayPause" class="btn-action btn-action-primary">
                        <i id="timerIcon" data-lucide="play" class="w-5 h-5"></i>
                        <span id="timerButtonText" class="ml-2">Mulai</span>
                    </button>
                    <button id="timerReset" class="btn-action bg-gray-600 hover:bg-gray-700 text-white">
                        <i data-lucide="rotate-ccw" class="w-5 h-5"></i>
                        <span class="ml-2">Reset</span>
                    </button>
                </div>
            </div>

            <!-- Statistics Card -->
            <div class="card-surface p-8">
                <div class="flex items-center gap-3 mb-6">
                    <div class="p-3 rounded-xl bg-gradient-to-br from-green-500 to-emerald-600 shadow-lg">
                        <i data-lucide="bar-chart-3" class="w-6 h-6 text-white"></i>
                    </div>
                    <div>
                        <h3 class="text-2xl font-black text-[--color-text-primary]">Statistik</h3>
                        <p class="text-sm text-[--color-text-secondary]">Progress pengerjaan</p>
                    </div>
                </div>

                <div class="space-y-6">
                    <div class="stats-card">
                        <div class="flex justify-between items-center mb-2">
                            <span class="text-[--color-text-secondary] font-semibold">Soal Dibuka</span>
                            <span class="text-3xl font-black text-[--color-text-primary]">
                                <span id="statsOpened">0</span>/<span id="statsTotal">15</span>
                            </span>
                        </div>
                        <div class="w-full bg-gray-700 rounded-full h-3 overflow-hidden">
                            <div id="statsProgress" class="h-full bg-gradient-to-r from-green-500 to-emerald-600 rounded-full transition-all duration-500" style="width: 0%"></div>
                        </div>
                    </div>

                    <div class="grid grid-cols-2 gap-4">
                        <div class="stats-card text-center">
                            <i data-lucide="eye" class="w-5 h-5 mx-auto mb-2 text-blue-500"></i>
                            <div class="text-2xl font-black text-[--color-text-primary]" id="statsViewCount">0</div>
                            <div class="text-xs text-[--color-text-secondary]">Total Dilihat</div>
                        </div>
                        <div class="stats-card text-center">
                            <i data-lucide="percent" class="w-5 h-5 mx-auto mb-2 text-purple-500"></i>
                            <div class="text-2xl font-black text-[--color-text-primary]" id="statsPercentage">0%</div>
                            <div class="text-xs text-[--color-text-secondary]">Persentase</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="grid" class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-6" aria-label="Daftar Soal"></section>

        <div class="mt-24 flex justify-center gap-4 flex-wrap">
            <button id="submitScoreBtn" class="btn-action bg-gradient-to-r from-amber-500 to-yellow-600 hover:from-amber-600 hover:to-yellow-700 text-white shadow-2xl shadow-amber-500/40 focus-ring">
                <i data-lucide="trophy" class="w-4 h-4"></i>
                <span class="ml-2">Submit Skor</span>
            </button>
            <button id="resetBtn" class="btn-action bg-gradient-to-r from-red-500 to-orange-600 hover:from-red-600 hover:to-orange-700 text-white shadow-2xl shadow-red-500/40 focus-ring">
                <i data-lucide="rotate-ccw" class="w-4 h-4"></i>
                <span class="ml-2">Reset Semua Soal</span>
            </button>
            <button id="resetStatsBtn" class="btn-action bg-gradient-to-r from-purple-500 to-pink-600 hover:from-purple-600 hover:to-pink-700 text-white shadow-2xl shadow-purple-500/40 focus-ring">
                <i data-lucide="bar-chart-3" class="w-4 h-4"></i>
                <span class="ml-2">Reset Statistik</span>
            </button>
        </div>
    </main>

    <!-- Modal Soal -->
    <div id="overlay" class="hidden fixed inset-0 z-[60] flex items-center justify-center bg-black/60 backdrop-blur-xl p-6 overlay-anim">
        <div id="modal" class="relative w-full max-w-3xl card-surface p-12 modal-anim" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
            <button id="closeModal" class="absolute right-5 top-5 p-2 rounded-full btn-icon hover:bg-opacity-80 focus-ring">
                <i data-lucide="x" class="w-5 h-5"></i>
            </button>

            <div class="flex items-start gap-5 mb-10">
                <div class="p-4 rounded-2xl bg-gradient-to-br from-blue-500 to-purple-600 shadow-lg shadow-blue-500/50">
                    <i data-lucide="file-text" class="w-7 h-7 text-white"></i>
                </div>
                <div>
                    <h2 id="modalTitle" class="text-4xl font-black text-[--color-text-primary] tracking-tight">Soal <span id="modalNumber"></span></h2>
                    <p class="text-sm text-[--color-text-secondary] mt-2 font-medium">Soal tipe esai - Jawab dengan lengkap dan terstruktur</p>
                </div>
            </div>

            <div id="modalBody" class="text-[--color-text-primary] leading-relaxed text-lg whitespace-pre-wrap bg-[--icon-bg] p-6 rounded-xl border border-[--card-border]"></div>

            <div class="mt-10 pt-6 border-t border-[--card-border] flex items-center justify-between">
                <div class="text-sm text-[--color-text-secondary] hidden md:block font-medium">
                    <kbd class="px-2 py-1 bg-[--icon-bg] rounded border border-[--card-border]">←</kbd> 
                    <kbd class="px-2 py-1 bg-[--icon-bg] rounded border border-[--card-border]">→</kbd> 
                    untuk navigasi • <kbd class="px-2 py-1 bg-[--icon-bg] rounded border border-[--card-border]">Esc</kbd> untuk tutup
                </div>
                <div class="flex gap-3">
                    <button id="prevBtn" class="p-3 rounded-xl btn-icon focus-ring"><i data-lucide="chevron-left" class="w-5 h-5"></i></button>
                    <button id="nextBtn" class="p-3 rounded-xl btn-icon focus-ring"><i data-lucide="chevron-right" class="w-5 h-5"></i></button>
                    <button id="modalCloseBtn" class="btn-action btn-action-primary focus-ring ml-2">
                        <i data-lucide="check" class="w-4 h-4"></i>
                        <span class="ml-2">Selesai</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Admin Overlay -->
    <div id="adminOverlay" class="hidden fixed inset-0 z-[70] flex items-center justify-center bg-black/60 backdrop-blur-xl p-6 no-print overlay-anim">
        <div class="relative w-full max-w-4xl card-surface p-10 modal-anim max-h-[90vh] overflow-y-auto">
            <button id="adminClose" class="absolute right-5 top-5 p-2 rounded-full btn-icon hover:bg-opacity-80 focus-ring">
                <i data-lucide="x" class="w-5 h-5"></i>
            </button>

            <div class="flex items-center gap-4 mb-8">
                <div class="p-3 rounded-xl bg-gradient-to-br from-red-500 to-pink-600 shadow-lg">
                    <i data-lucide="shield" class="w-6 h-6 text-white"></i>
                </div>
                <div>
                    <h3 class="text-3xl font-black text-[--color-text-primary]">Admin Panel</h3>
                    <p class="text-sm text-[--color-text-secondary] mt-1">Kelola dan edit soal di bawah ini</p>
                </div>
            </div>

            <div id="adminList" class="grid gap-4 max-h-96 overflow-y-auto mb-8 pr-4"></div>

            <div class="flex gap-3 justify-end">
                <button id="adminSave" class="btn-action bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white shadow-lg shadow-green-500/30">
                    <i data-lucide="save" class="w-4 h-4"></i>
                    <span class="ml-2">Simpan Perubahan</span>
                </button>
                <button id="adminCancel" class="btn-action bg-gray-600 hover:bg-gray-700 text-white">
                    <span>Batal</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Leaderboard Overlay -->
    <div id="leaderboardOverlay" class="hidden fixed inset-0 z-[70] flex items-center justify-center bg-black/60 backdrop-blur-xl p-6 no-print overlay-anim">
        <div class="relative w-full max-w-4xl card-surface p-10 modal-anim max-h-[90vh] overflow-y-auto">
            <button id="leaderboardClose" class="absolute right-5 top-5 p-2 rounded-full btn-icon hover:bg-opacity-80 focus-ring">
                <i data-lucide="x" class="w-5 h-5"></i>
            </button>

            <div class="flex items-center gap-4 mb-8">
                <div class="p-3 rounded-xl bg-gradient-to-br from-amber-500 to-orange-600 shadow-lg">
                    <i data-lucide="trophy" class="w-6 h-6 text-white"></i>
                </div>
                <div>
                    <h3 class="text-3xl font-black text-[--color-text-primary]">Leaderboard</h3>
                    <p class="text-sm text-[--color-text-secondary] mt-1">Top skor dari semua peserta</p>
                </div>
            </div>

            <div id="leaderboardList" class="space-y-3 mb-6"></div>

            <div class="flex gap-3 justify-end">
                <button id="clearLeaderboard" class="btn-action bg-gradient-to-r from-red-500 to-pink-600 hover:from-red-600 hover:to-pink-700 text-white shadow-lg shadow-red-500/30">
                    <i data-lucide="trash-2" class="w-4 h-4"></i>
                    <span class="ml-2">Hapus Semua</span>
                </button>
                <button id="leaderboardCloseBtn" class="btn-action bg-gray-600 hover:bg-gray-700 text-white">
                    <span>Tutup</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Submit Score Overlay -->
    <div id="submitScoreOverlay" class="hidden fixed inset-0 z-[70] flex items-center justify-center bg-black/60 backdrop-blur-xl p-6 no-print overlay-anim">
        <div class="relative w-full max-w-md card-surface p-10 modal-anim">
            <button id="submitScoreClose" class="absolute right-5 top-5 p-2 rounded-full btn-icon hover:bg-opacity-80 focus-ring">
                <i data-lucide="x" class="w-5 h-5"></i>
            </button>

            <div class="flex items-center gap-4 mb-8">
                <div class="p-3 rounded-xl bg-gradient-to-br from-amber-500 to-orange-600 shadow-lg">
                    <i data-lucide="trophy" class="w-6 h-6 text-white"></i>
                </div>
                <div>
                    <h3 class="text-3xl font-black text-[--color-text-primary]">Submit Skor</h3>
                    <p class="text-sm text-[--color-text-secondary] mt-1">Masukkan nama dan skor Anda</p>
                </div>
            </div>

            <form id="submitScoreForm" class="space-y-6">
                <div>
                    <label class="block text-sm font-bold text-[--color-text-primary] mb-2">Nama Lengkap</label>
                    <input type="text" id="scoreNameInput" required
                        class="w-full p-4 rounded-lg bg-[--card-bg] text-[--color-text-primary] border border-[--card-border] focus:outline-none focus:ring-2 focus:ring-[--color-accent-blue] transition-all"
                        placeholder="Masukkan nama Anda">
                </div>

                <div>
                    <label class="block text-sm font-bold text-[--color-text-primary] mb-2">Skor</label>
                    <input type="number" id="scoreValueInput" required min="0" max="100"
                        class="w-full p-4 rounded-lg bg-[--card-bg] text-[--color-text-primary] border border-[--card-border] focus:outline-none focus:ring-2 focus:ring-[--color-accent-blue] transition-all"
                        placeholder="0-100">
                </div>

                <div class="stats-card">
                    <div class="text-sm text-[--color-text-secondary] mb-2">Statistik Saat Ini:</div>
                    <div class="flex justify-between text-[--color-text-primary] font-bold">
                        <span>Soal Dibuka:</span>
                        <span id="currentStatsOpened">0/15</span>
                    </div>
                    <div class="flex justify-between text-[--color-text-primary] font-bold">
                        <span>Persentase:</span>
                        <span id="currentStatsPercentage">0%</span>
                    </div>
                </div>

                <div class="flex gap-3">
                    <button type="submit" class="btn-action btn-action-primary flex-1">
                        <i data-lucide="check" class="w-4 h-4"></i>
                        <span class="ml-2">Submit</span>
                    </button>
                    <button type="button" id="submitScoreCancel" class="btn-action bg-gray-600 hover:bg-gray-700 text-white">
                        <span>Batal</span>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script>
        lucide.createIcons();

        const DEFAULT_QUESTIONS = [
            "Jelaskan apa yang dimaksud dengan BCD (Binary Coded Decimal) menurut penjelasan modul!",
            "Jelaskan perbedaan antara sandi berbobot dan sandi tidak berbobot sebagaimana dijelaskan dalam materi!",
            "Jelaskan bagaimana hubungan antara counter dan decoder dalam proses menampilkan angka pada seven segment!",
            "Jelaskan fungsi seven segment serta cara kerja segmen a–g dalam menampilkan angka!",
            "Jelaskan fungsi IC TTL 7447 dalam rangkaian seven segment common anoda!",
            "Jelaskan fungsi IC TTL 7448 dan bagaimana perbedaannya dengan IC 7447!",
            "Jelaskan fungsi jalur LT, RBI, dan RBO pada IC decoder seven segment!",
            "Jelaskan cara kerja encoder menggunakan IC 74HC147 berdasarkan percobaan dalam modul!",
            "Jelaskan mengapa output encoder 74HC147 diarahkan ke IC 7404 sebelum digunakan!",
            "Jelaskan bagaimana cara kerja rangkaian decoder seven segment common anoda menggunakan IC 7447!",
            "Jelaskan perbedaan rangkaian decoder seven segment common anoda dan common katoda!",
            "Jelaskan bagaimana tabel segment (a–g) menentukan angka yang ditampilkan pada seven segment!",
            "Jelaskan langkah-langkah TinkerCad pada percobaan encoder seperti yang dijelaskan dalam modul!",
            "Jelaskan alasan pemasangan resistor 220 Ohm pada rangkaian seven segment!",
            "Bisakah rangkaian encoder dan decoder diintegrasikan dalam satu sistem? Jika memungkinkan, jelaskan bagaimana cara penggabungannya. Jika tidak memungkinkan, jelaskan alasannya!"
        ];

        let QUESTIONS = [];
        let openedQuestions = new Set();
        let viewCount = 0;
        let leaderboard = [];
        const grid = document.getElementById('grid');
        
        // Timer Variables
        let timerInterval = null;
        let timerSeconds = 15 * 60;
        let timerRunning = false;
        let selectedMinutes = 15;

        // Audio Context for Timer Sound
        const audioContext = new (window.AudioContext || window.webkitAudioContext)();

        function playTimerSound() {
            // Create a pleasant alarm sound
            const now = audioContext.currentTime;
            const oscillator1 = audioContext.createOscillator();
            const oscillator2 = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator1.connect(gainNode);
            oscillator2.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator1.frequency.value = 800;
            oscillator2.frequency.value = 1000;
            oscillator1.type = 'sine';
            oscillator2.type = 'sine';
            
            gainNode.gain.setValueAtTime(0.3, now);
            gainNode.gain.exponentialRampToValueAtTime(0.01, now + 0.5);
            
            oscillator1.start(now);
            oscillator2.start(now);
            oscillator1.stop(now + 0.5);
            oscillator2.stop(now + 0.5);
            
            // Play 3 beeps
            setTimeout(() => playBeep(), 600);
            setTimeout(() => playBeep(), 1200);
        }

        function playBeep() {
            const now = audioContext.currentTime;
            const osc = audioContext.createOscillator();
            const gain = audioContext.createGain();
            
            osc.connect(gain);
            gain.connect(audioContext.destination);
            
            osc.frequency.value = 900;
            osc.type = 'sine';
            gain.gain.setValueAtTime(0.2, now);
            gain.gain.exponentialRampToValueAtTime(0.01, now + 0.3);
            
            osc.start(now);
            osc.stop(now + 0.3);
        }

        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
        }

        function updateTimerDisplay() {
            const display = document.getElementById('timerDisplay');
            display.textContent = formatTime(timerSeconds);
            
            if (timerSeconds < 60) {
                display.classList.add('warning');
            } else {
                display.classList.remove('warning');
            }
        }

        function startTimer() {
            if (timerRunning) return;
            timerRunning = true;
            
            const playPauseBtn = document.getElementById('timerPlayPause');
            const icon = document.getElementById('timerIcon');
            const text = document.getElementById('timerButtonText');
            
            icon.setAttribute('data-lucide', 'pause');
            text.textContent = 'Pause';
            lucide.createIcons();
            
            timerInterval = setInterval(() => {
                timerSeconds--;
                updateTimerDisplay();
                
                if (timerSeconds <= 0) {
                    stopTimer();
                    playTimerSound();
                    alert('⏰ Waktu Habis! Timer telah selesai.');
                }
            }, 1000);
        }

        function stopTimer() {
            timerRunning = false;
            clearInterval(timerInterval);
            
            const playPauseBtn = document.getElementById('timerPlayPause');
            const icon = document.getElementById('timerIcon');
            const text = document.getElementById('timerButtonText');
            
            icon.setAttribute('data-lucide', 'play');
            text.textContent = 'Mulai';
            lucide.createIcons();
        }

        function resetTimer() {
            stopTimer();
            timerSeconds = selectedMinutes * 60;
            updateTimerDisplay();
        }

        // Timer Event Listeners
        document.getElementById('timerPlayPause').addEventListener('click', () => {
            if (timerRunning) {
                stopTimer();
            } else {
                startTimer();
            }
        });

        document.getElementById('timerReset').addEventListener('click', resetTimer);

        document.querySelectorAll('.timer-preset').forEach(btn => {
            btn.addEventListener('click', (e) => {
                selectedMinutes = parseInt(e.currentTarget.dataset.minutes);
                stopTimer();
                timerSeconds = selectedMinutes * 60;
                updateTimerDisplay();
                
                // Update active button style
                document.querySelectorAll('.timer-preset').forEach(b => {
                    b.classList.remove('bg-blue-600', 'hover:bg-blue-700');
                    b.classList.add('bg-gray-600', 'hover:bg-gray-700');
                });
                e.currentTarget.classList.remove('bg-gray-600', 'hover:bg-gray-700');
                e.currentTarget.classList.add('bg-blue-600', 'hover:bg-blue-700');
            });
        });

        // Statistics Functions
        function updateStats() {
            const total = QUESTIONS.length;
            const opened = openedQuestions.size;
            const percentage = total > 0 ? Math.round((opened / total) * 100) : 0;
            
            document.getElementById('statsOpened').textContent = opened;
            document.getElementById('statsTotal').textContent = total;
            document.getElementById('statsViewCount').textContent = viewCount;
            document.getElementById('statsPercentage').textContent = percentage + '%';
            document.getElementById('statsProgress').style.width = percentage + '%';
            
            // Update current stats in submit form if visible
            const currentStatsOpened = document.getElementById('currentStatsOpened');
            const currentStatsPercentage = document.getElementById('currentStatsPercentage');
            if (currentStatsOpened) currentStatsOpened.textContent = `${opened}/${total}`;
            if (currentStatsPercentage) currentStatsPercentage.textContent = percentage + '%';
            
            // Save to localStorage
            localStorage.setItem('pretest_opened', JSON.stringify([...openedQuestions]));
            localStorage.setItem('pretest_viewcount', viewCount);
        }

        function loadStats() {
            const saved = localStorage.getItem('pretest_opened');
            const savedCount = localStorage.getItem('pretest_viewcount');
            
            if (saved) {
                openedQuestions = new Set(JSON.parse(saved));
            }
            if (savedCount) {
                viewCount = parseInt(savedCount);
            }
            
            updateStats();
        }

        function resetStats() {
            if (!confirm('Reset semua statistik pengerjaan?')) return;
            openedQuestions.clear();
            viewCount = 0;
            localStorage.removeItem('pretest_opened');
            localStorage.removeItem('pretest_viewcount');
            updateStats();
            renderCards();
        }

        document.getElementById('resetStatsBtn').addEventListener('click', resetStats);

        // Leaderboard Functions
        function loadLeaderboard() {
            const saved = localStorage.getItem('pretest_leaderboard');
            if (saved) {
                leaderboard = JSON.parse(saved);
            }
        }

        function saveLeaderboard() {
            localStorage.setItem('pretest_leaderboard', JSON.stringify(leaderboard));
        }

        function renderLeaderboard() {
            const list = document.getElementById('leaderboardList');
            list.innerHTML = '';

            if (leaderboard.length === 0) {
                list.innerHTML = '<div class="text-center text-[--color-text-secondary] py-8">Belum ada data skor. Submit skor pertama Anda!</div>';
                lucide.createIcons();
                return;
            }

            // Sort by score descending
            const sorted = [...leaderboard].sort((a, b) => b.score - a.score);

            sorted.forEach((entry, idx) => {
                const rank = idx + 1;
                const rankColors = {
                    1: 'from-yellow-500 to-amber-600',
                    2: 'from-gray-400 to-gray-500',
                    3: 'from-orange-600 to-orange-700'
                };
                const rankColor = rankColors[rank] || 'from-blue-500 to-purple-600';

                const item = el('div', 'card-surface p-4 flex items-center gap-4');
                item.innerHTML = `
                    <div class="w-12 h-12 rounded-full bg-gradient-to-br ${rankColor} flex items-center justify-center text-white font-black text-xl shadow-lg">
                        ${rank}
                    </div>
                    <div class="flex-1">
                        <div class="text-lg font-bold text-[--color-text-primary]">${entry.name}</div>
                        <div class="text-sm text-[--color-text-secondary]">${entry.date}</div>
                    </div>
                    <div class="text-right">
                        <div class="text-3xl font-black text-[--color-text-primary]">${entry.score}</div>
                        <div class="text-xs text-[--color-text-secondary]">poin</div>
                    </div>
                    <button class="btn-icon delete-score" data-index="${leaderboard.findIndex(e => e === entry)}">
                        <i data-lucide="trash-2" class="w-4 h-4 text-red-500"></i>
                    </button>
                `;
                list.appendChild(item);
            });

            // Add delete handlers
            document.querySelectorAll('.delete-score').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const index = parseInt(e.currentTarget.dataset.index);
                    if (confirm('Hapus entri ini dari leaderboard?')) {
                        leaderboard.splice(index, 1);
                        saveLeaderboard();
                        renderLeaderboard();
                    }
                });
            });

            lucide.createIcons();
        }

        function openLeaderboard() {
            document.getElementById('leaderboardOverlay').classList.remove('hidden');
            renderLeaderboard();
            document.body.style.overflow = 'hidden';
        }

        function closeLeaderboard() {
            document.getElementById('leaderboardOverlay').classList.add('hidden');
            document.body.style.overflow = '';
        }

        document.getElementById('leaderboardBtn').addEventListener('click', openLeaderboard);
        document.getElementById('leaderboardClose').addEventListener('click', closeLeaderboard);
        document.getElementById('leaderboardCloseBtn').addEventListener('click', closeLeaderboard);
        
        document.getElementById('clearLeaderboard').addEventListener('click', () => {
            if (confirm('Hapus SEMUA data leaderboard? Tindakan ini tidak dapat dibatalkan!')) {
                leaderboard = [];
                saveLeaderboard();
                renderLeaderboard();
                alert('✅ Leaderboard telah dihapus.');
            }
        });

        document.getElementById('leaderboardOverlay').addEventListener('click', (ev) => {
            if (ev.target.id === 'leaderboardOverlay') closeLeaderboard();
        });

        // Submit Score Functions
        function openSubmitScore() {
            document.getElementById('submitScoreOverlay').classList.remove('hidden');
            updateStats(); // Update current stats display
            document.body.style.overflow = 'hidden';
            setTimeout(() => document.getElementById('scoreNameInput').focus(), 100);
        }

        function closeSubmitScore() {
            document.getElementById('submitScoreOverlay').classList.add('hidden');
            document.body.style.overflow = '';
            document.getElementById('submitScoreForm').reset();
        }

        document.getElementById('submitScoreBtn').addEventListener('click', openSubmitScore);
        document.getElementById('submitScoreClose').addEventListener('click', closeSubmitScore);
        document.getElementById('submitScoreCancel').addEventListener('click', closeSubmitScore);

        document.getElementById('submitScoreOverlay').addEventListener('click', (ev) => {
            if (ev.target.id === 'submitScoreOverlay') closeSubmitScore();
        });

        document.getElementById('submitScoreForm').addEventListener('submit', (e) => {
            e.preventDefault();
            
            const name = document.getElementById('scoreNameInput').value.trim();
            const score = parseInt(document.getElementById('scoreValueInput').value);

            if (!name || isNaN(score) || score < 0 || score > 100) {
                alert('⚠️ Mohon isi nama dan skor dengan benar (0-100).');
                return;
            }

            const now = new Date();
            const dateStr = now.toLocaleString('id-ID', {
                day: '2-digit',
                month: 'short',
                year: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });

            const entry = {
                name: name,
                score: score,
                date: dateStr,
                timestamp: now.getTime()
            };

            leaderboard.push(entry);
            saveLeaderboard();
            
            closeSubmitScore();
            alert(`✅ Skor berhasil disimpan!\n\nNama: ${name}\nSkor: ${score}`);
            
            // Auto open leaderboard
            setTimeout(() => openLeaderboard(), 300);
        });
        
        function el(tag, cls = '', html = '') {
            const e = document.createElement(tag);
            if (cls) e.className = cls;
            if (html) e.innerHTML = html;
            return e;
        }

        function renderCards() {
            grid.innerHTML = '';

            QUESTIONS.forEach((q, idx) => {
                const n = idx + 1;
                const isOpened = openedQuestions.has(n);
                
                const card = el('div', `relative card-surface p-6 h-40 flex flex-col justify-between cursor-pointer focus-ring ${isOpened ? 'question-opened' : ''}`);
                card.style.animation = `cardEnter 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) both`;
                card.style.animationDelay = `${idx * 40}ms`;

                const top = el('div', 'relative z-10 flex items-start justify-between');
                top.innerHTML = `
                    <div class="card-number text-6xl font-black leading-none">${n}</div>
                    <div class="badge">
                        <i data-lucide="file-text" class="w-3 h-3"></i>
                        <span>Esai</span>
                    </div>
                `;
                
                const desc = el('div', 'relative z-10 text-sm text-[--color-text-primary] font-bold mt-3 flex items-center gap-2');
                desc.innerHTML = '<i data-lucide="arrow-right" class="w-4 h-4"></i> Klik untuk Lihat Soal';

                card.appendChild(top);
                card.appendChild(desc);

                card.tabIndex = 0;
                card.addEventListener('click', () => openModal(idx + 1));
                card.addEventListener('keyup', (e) => {
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        openModal(idx + 1);
                    }
                });

                card.addEventListener('mousemove', (e) => {
                    const rect = card.getBoundingClientRect();
                    const x = ((e.clientX - rect.left) / rect.width) * 100;
                    const y = ((e.clientY - rect.top) / rect.height) * 100;
                    card.style.setProperty('--mouse-x', `${x}%`);
                    card.style.setProperty('--mouse-y', `${y}%`);
                });

                grid.appendChild(card);
            });

            lucide.createIcons();
        }

        // Modal Soal
        const overlay = document.getElementById('overlay');
        const modalBody = document.getElementById('modalBody');
        const modalNumber = document.getElementById('modalNumber');
        const closeModalBtn = document.getElementById('closeModal');
        const modalCloseBtn = document.getElementById('modalCloseBtn');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');

        let activeIndex = 0;

        function openModal(n) {
            activeIndex = n - 1;
            
            // Track statistics
            if (!openedQuestions.has(n)) {
                openedQuestions.add(n);
            }
            viewCount++;
            updateStats();
            renderCards();
            
            renderModal();
            overlay.classList.remove('hidden');
            document.body.style.overflow = 'hidden';
            setTimeout(() => closeModalBtn.focus(), 100);
            window.addEventListener('keydown', modalKeyHandler);
        }

        function closeModal() {
            overlay.classList.add('hidden');
            document.body.style.overflow = '';
            window.removeEventListener('keydown', modalKeyHandler);
        }

        function renderModal() {
            modalNumber.textContent = activeIndex + 1;
            modalBody.textContent = QUESTIONS[activeIndex];
            lucide.createIcons();
        }

        function modalKeyHandler(e) {
            if (e.key === 'Escape') {
                e.preventDefault();
                closeModal();
            }
            if (e.key === 'ArrowLeft') {
                e.preventDefault();
                activeIndex = (activeIndex - 1 + QUESTIONS.length) % QUESTIONS.length;
                const n = activeIndex + 1;
                if (!openedQuestions.has(n)) {
                    openedQuestions.add(n);
                }
                viewCount++;
                updateStats();
                renderCards();
                renderModal();
            }
            if (e.key === 'ArrowRight') {
                e.preventDefault();
                activeIndex = (activeIndex + 1) % QUESTIONS.length;
                const n = activeIndex + 1;
                if (!openedQuestions.has(n)) {
                    openedQuestions.add(n);
                }
                viewCount++;
                updateStats();
                renderCards();
                renderModal();
            }
        }

        closeModalBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            closeModal();
        });
        
        modalCloseBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            closeModal();
        });
        
        prevBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            activeIndex = (activeIndex - 1 + QUESTIONS.length) % QUESTIONS.length;
            const n = activeIndex + 1;
            if (!openedQuestions.has(n)) {
                openedQuestions.add(n);
            }
            viewCount++;
            updateStats();
            renderCards();
            renderModal();
        });
        
        nextBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            activeIndex = (activeIndex + 1) % QUESTIONS.length;
            const n = activeIndex + 1;
            if (!openedQuestions.has(n)) {
                openedQuestions.add(n);
            }
            viewCount++;
            updateStats();
            renderCards();
            renderModal();
        });
        
        overlay.addEventListener('click', (ev) => {
            if (ev.target === overlay) closeModal();
        });

        // Theme Toggle
        const htmlElement = document.documentElement;
        const themeToggle = document.getElementById('themeToggle');
        const themeIcon = document.getElementById('themeIcon');

        function getTheme() {
            return localStorage.getItem('theme') || (window.matchMedia('(prefers-color-scheme: light)').matches ? 'light' : 'dark');
        }

        function setTheme(theme) {
            localStorage.setItem('theme', theme);
            if (theme === 'light') {
                htmlElement.classList.add('light');
                themeIcon.setAttribute('data-lucide', 'moon');
                themeToggle.title = 'Ganti ke Dark Mode';
            } else {
                htmlElement.classList.remove('light');
                themeIcon.setAttribute('data-lucide', 'sun');
                themeToggle.title = 'Ganti ke Light Mode';
            }
            lucide.createIcons();
        }

        themeToggle.addEventListener('click', () => {
            const currentTheme = getTheme();
            setTheme(currentTheme === 'dark' ? 'light' : 'dark');
        });

        // Reset Questions
        document.getElementById('resetBtn').addEventListener('click', () => {
            if (!confirm('Apakah Anda yakin ingin MERESET semua soal ke default? Semua perubahan soal yang Anda buat akan hilang.')) return;
            QUESTIONS = DEFAULT_QUESTIONS.slice();
            localStorage.removeItem('pretest_questions');
            renderCards();
            alert('Soal berhasil direset ke daftar default.');
        });

        // Admin Panel
        const adminBtn = document.getElementById('adminBtn');
        const adminOverlay = document.getElementById('adminOverlay');
        const adminClose = document.getElementById('adminClose');
        const adminList = document.getElementById('adminList');
        const adminSave = document.getElementById('adminSave');
        const adminCancel = document.getElementById('adminCancel');

        function openAdmin() {
            adminOverlay.classList.remove('hidden');
            adminList.innerHTML = '';
            QUESTIONS.forEach((q, i) => {
                const row = el('div', 'flex gap-3 items-start p-4 card-surface');
                const num = el('div', 'w-10 pt-2 text-lg font-black text-[--color-accent-blue]', String(i + 1) + '.');
                const textarea = el('textarea');
                textarea.className = 'flex-1 p-4 rounded-lg bg-[--card-bg] text-sm text-[--color-text-primary] border border-[--card-border] focus:outline-none focus:ring-2 focus:ring-[--color-accent-blue] resize-y transition-all';
                textarea.style.minHeight = '100px';
                textarea.value = q;
                row.appendChild(num);
                row.appendChild(textarea);
                adminList.appendChild(row);
            });
            document.body.style.overflow = 'hidden';
            setTimeout(() => {
                lucide.createIcons();
            }, 50);
        }

        function closeAdmin() {
            adminOverlay.classList.add('hidden');
            document.body.style.overflow = '';
        }

        adminBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            openAdmin();
        });
        
        adminClose.addEventListener('click', (e) => {
            e.stopPropagation();
            closeAdmin();
        });
        
        adminCancel.addEventListener('click', (e) => {
            e.stopPropagation();
            closeAdmin();
        });
        
        adminOverlay.addEventListener('click', (ev) => {
            if (ev.target === adminOverlay) closeAdmin();
        });

        adminSave.addEventListener('click', (e) => {
            e.stopPropagation();
            const texts = Array.from(adminList.querySelectorAll('textarea')).map(t => t.value.trim()).filter(Boolean);
            if (texts.length === 0) {
                alert('Daftar soal tidak boleh kosong.');
                return;
            }
            QUESTIONS = texts;
            localStorage.setItem('pretest_questions', JSON.stringify(QUESTIONS));
            renderCards();
            closeAdmin();
            alert('✅ Soal berhasil tersimpan dan diperbarui!');
        });

        function init() {
            setTheme(getTheme());
            const saved = localStorage.getItem('pretest_questions');
            QUESTIONS = saved ? JSON.parse(saved) : DEFAULT_QUESTIONS.slice();
            renderCards();
            loadStats();
            loadLeaderboard();
            updateTimerDisplay();
        }
        
        init();
    </script>
</body>
</html>